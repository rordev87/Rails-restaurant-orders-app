<p id="notice"><%= notice %></p>

<p>
  <strong>Meal:</strong>
  <%= @order.meal %>
</p>

<p>
  <strong>Restaurant:</strong>
  <%= @order.restaurant %>
</p>


<p>
  <strong>Status:</strong>
  <%= @order.status %>
</p>

<h2>items</h2>
<table>
	<thead>
	    <tr>
	    	<th>User</th>
	      	<th>Name</th>
	      	<th>Quantity</th>
	      	<th>Price</th>
	      	<th>Comment</th>
	      	<th>Delete</th>
	    </tr>
	</thead>
	<tbody>
		<%= render @order.items %>
	</tbody>
</table>

<h2>Invited</h2>
<table>
	<thead>
	    <tr>
	    	<th>User</th>
	      	<th>email</th>
	      	<th>Delete</th>
          <th>Join</th>
	    </tr>
	</thead>
	<tbody>
		<% @invitedFriends.each do |friend| %>
      		<tr>
        		<td><%= friend.name %></td>
        		<td><%= friend.email %></td>
        		<td><%= if current_user.id == @order.user_id
                      link_to 'Destroy',  removeUserfromorder_path(@order.id, friend.id), method: :delete, data: { confirm: 'Are you sure?' }
                    end %></td>
            <td><%= if current_user.id == @order.user_id || current_user.id == friend.id
                      link_to 'Join',  joinuserinorder_path(@order.id, friend.id), method: :put 
                    end %></td>
      		</tr>
    	<% end %>
	</tbody>
	
</table>

<h2>Joined</h2>
<table>
	<thead>
	    <tr>
	    	<th>User</th>
	      	<th>email</th>
	      	<th>Delete</th>
	    </tr>
	</thead>
	<tbody>
		<% @joinedFriends.each do |friend| %>
      		<tr>
        		<td><%= friend.name %></td>
        		<td><%= friend.email %></td>
        		<td><%=  if current_user.id == @order.user_id
                       link_to 'Destroy',  removeUserfromorder_path(@order.id, friend.id), method: :delete, data: { confirm: 'Are you sure?' } 
                       end %></td>
      		</tr>
    	<% end %>
	</tbody>
	
</table>

<%= form_for(@item, url: order_items_path(@order.id)) do |f| %>

  <div class="field">
    <%= f.label :name %><br>
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :quantity %><br>
    <%= f.number_field :quantity %>
  </div>
  <div class="field">
    <%= f.label :price %><br>
    <%= f.number_field :price %>
  </div>
  <div class="field">
    <%= f.label :comment %><br>
    <%= f.text_area :comment %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>

<h2>Invite a friend</h2>
<%= form_for User.new, url: new_member_order_path(@order.id) do |f| %>
  <div class="field">
    <%= f.label :email %><br>
    <%= f.text_field :email %>
  </div>
  <div class="actions">
  <%= f.submit  %>
  </div>
<% end %>


<fieldset class="col-sm-12" style="overflow-y: scroll; margin-top:10px;">
  <legend>Invited Friends:</legend>
  <% @orderuserjoin.each do |user| %>
    <% if user.order_id == @order.id %>
    <% @users.each do |username| %>
    <% if username.id == user.user_id %>
    <div class="col-sm-4">
      <img class="col-sm-5" src="">
      <div class="col-sm-6">
        <span class="col-sm-12">
          <%= username.name %></span>
          <% end %>
          <% end %>
          <% end %>
        </div>
    </div>
  <% end %>
</fieldset>


<%= link_to 'Edit', edit_order_path(@order) %> |
<%= link_to 'Back', orders_path %>


<%= form_for User.new, url: new_member_order_path(@order.id) do |t| %>
  
  <div class="field">
    <%= t.label :email %><br>
    <%= t.text_field :email %>
  </div>
  <div class="actions">
  <%= t.submit  %>
  </div>
<% end %>

<fieldset class="col-sm-12" style="overflow-y: scroll; margin-top:10px;">
  <legend>Members :</legend>
  <% @orderuserjoin.each do |user| %>
    <% if user.order_id == @order.id %>
    <% @users.each do |username| %>
    <% if username.id == user.user_id %>
    <div class="col-sm-4">
      <img class="col-sm-5" src="">
      <div class="col-sm-6">
        <span class="col-sm-12">
          <%= username.name %></span>
          <% end %>
          <% end %>
          <% end %>
        </div>
    </div>
  <% end %>
</fieldset>